/** * @package Metadesc Component * @version 0.95 * @author Sergey Osipov <info@devstratum.ru> * @website https://devstratum.ru * @copyright (c) 2022 Sergey Osipov. All Rights Reserved * @license GNU GPL v2.0 * @report https://github.com/devstratum/metadesc/issues */
document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("modal-metadesc"),t=new bootstrap.Modal(e,{}),o=e.querySelector(".modal-dialog"),n=e.querySelector(".metadesc-form__title"),c=e.querySelector(".metadesc-form__group"),d=e.querySelector(".metadesc-form__alert"),r=e.querySelector(".metadesc-form__progress"),a=e.querySelector(".button-apply"),s=e.querySelector(".button-cancel"),l,i;var m='<label for="form_description">'+Joomla.JText._("COM_METADESC_FIELD_DESCRIPTION")+'</label><textarea name="description" id="form_description" class="form-control" cols="30" rows="4" maxlength="160"></textarea>';o.classList.add("modal-dialog-centered"),e.addEventListener("show.bs.modal",function(e){d.innerHTML="";let t=e.relatedTarget;i=t.getAttribute("data-bs-id"),l=t.getAttribute("data-bs-type");let o=document.getElementById("metadesc_"+i);e=o.querySelector(".metadesc-title");let r=o.querySelector(".metadesc-description");n.textContent=e.textContent,c.innerHTML=m;let a=c.querySelector("textarea");"object"==typeof r&&null!==r&&(r.classList.remove("update"),a.value=r.querySelector(".text").textContent),shortAndSweet(a,{counterLabel:Joomla.JText._("COM_METADESC_FIELD_DESCRIPTION_COUNT")})}),s.addEventListener("click",function(){t.hide()}),a.addEventListener("click",function(){var e,t,o=c.querySelector("textarea").value;e=i,t=l,o=o,Joomla.request({url:"index.php?option=com_metadesc&task=metadesc."+t+"&id="+e,method:"POST",headers:{"Cache-Control":"no-cache","Content-Type":"application/json"},data:JSON.stringify({id:e,description:o}),onBefore:function(){d.innerHTML="",a.disabled=!0,r.classList.add("active")},onSuccess:function(e){var t=JSON.parse(e);e=t.message,d.innerHTML='<div class="alert alert-'+e.type+'">'+e.text+"</div>",function(a){if(0!==a.length&&a.description){var n=String(a.description);let e=document.getElementById("metadesc_"+i),t=e.querySelector(".metadesc-badge"),o=e.querySelector(".metadesc-count"),r=e.querySelector(".metadesc-description");o.textContent=String(n.length),t.classList.remove("bg-danger"),t.classList.add("bg-success"),r.classList.remove("hidden"),r.classList.add("update"),r.querySelector(".text").textContent=n}if(0!==a.length&&a.checkout){let e=document.getElementById("metadesc_"+i),t=e.querySelector(".metadesc-button"),o=e.querySelector(".metadesc-cheockout");t.classList.add("hidden"),o.classList.remove("hidden")}}(t.data)},onError:function(){console.log("ajax error")},onComplete:function(){a.disabled=!1,r.classList.remove("active")}})})});